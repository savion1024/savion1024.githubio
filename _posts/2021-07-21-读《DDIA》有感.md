---
layout:     post
title:      读《DDIA》有感
subtitle:   一些收获
date:       2021-07-21
author:     savion
header-img: img/post-bg-cook.jpg
catalog: true
tags:
- 思考
- 分布式
---


## 这本书讲了什么

这本书分成两部分，第一部分介绍了了数据系统底层的基础概念，第二部分讨论在分布式数据系统中特有的问题。
于我而言，最有收获就是第二部分。简单总结一下一些思想

## 复制

出于以下原因，我们希望能复制数据，有可能是从一个复制到多个，也有可能是从多个复制到多个，但是不论怎样。我们总是面临一些挑战

- 使得数据与⽤用在地理上接近(从而减少延迟)
- 即使系统的⼀部分出现故障，系统也能继续工作(从而提高可用性)
- 扩展可以接受读请求的机器数量(从而提高读取吞吐量

其中第三点是我们经常遇到的，例如我们有一个数据库集群，大量读写的情况。此时我们可以将节点分成读写两种节点，一个主节点负责处理写请求，另外若干个从节点负责读请求。
其中从节点从主节点拉取变更以维持同步。 在这种工作模式下。将大大提高数据库的吞吐能力，当某个读节点故障时，还有其他读节点冗余可以提供服务，当主节点故障时，可以执行主备切换，从节点升级为主节点。

当然各个数据库的具体实现方式或有异同。但是思想却是一致的。通过 研究`raft`算法会有更深的认识。

这种方式面临着一些问题，比如
- 如何进行同步
- 同步带来的延迟问题

等等，这些问题在书里都有一个整理分析。


## 分区

对于非常大的数据集,或非常高的吞吐量， 仅进行复制是不够的:我们需要将数据进行分区(partitions)，也称为分片(sharding)

例如在redis集群中，通过划分槽位，同时将数据哈希的方式将数据散列到多个节点中，每个节点承担一部分数据，降低了每个节点的负载。
再比如kafka中的分区，一个topic的数据 通过分区分散到多个borker中，在分区范围内保证有序。这就是分区的思想。

分区带来一个显而易见的问题，`数据倾斜`， 例如某个节点承担的数据过多，再比如kafka的`重平衡问题`。这些不在这里赘述。



## 参考
- http://thesecretlivesofdata.com/raft/    raft算法可视化




